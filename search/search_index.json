{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Archeo","text":"<p>Archeo is a Python package designed to infer the natal kick, ancestral masses, and spins of black holes in the Pair-instability Supernova (PISN) gap, with a particular focus on hierarchical black hole formation. Please check out our methodology if you are interested.</p>"},{"location":"#publications","title":"Publications","text":"<p>Here we list the publications that have used Archeo:</p> <p>[1] Carlos Ara\u00fajo \u00c1lvarez, Henry W. Y. Wong, Juan Calder\u00f3n Bustillo. \"Kicking Time Back in Black Hole Mergers: Ancestral Masses, Spins, Birth Recoils, and Hierarchical-formation Viability of GW190521.\" The Astrophysical Journal 977.2 (2024): 220.</p> <p>[2] The LIGO Scientific Collaboration, the Virgo Collaboration, the KAGRA Collaboration. \"GW231123: a Binary Black Hole Merger with Total Mass 190-265 $M_\\odot$.\" The Astrophysical Journal Letters 993 L25.</p> <p>[3] The LIGO Scientific Collaboration, the Virgo Collaboration, the KAGRA Collaboration. \"GW241011 and GW241110: Exploring Binary Formation and Fundamental Physics with Asymmetric, High-spin Black Hole Coalescences.\" The Astrophysical Journal Letters 993.1 (2025): L21.</p>"},{"location":"#getting-help","title":"Getting Help","text":"<p>The code is maintained by Henry Wong under Juan Calderon Bustillo's supervision. You can find the list of contributors here. Please report bugs by raising an issue on our GitHub repository.</p>"},{"location":"code-overview/","title":"Code Overview","text":"<p>To be ready!</p>"},{"location":"installation/","title":"Installation","text":"<p>Our package archeo is available via PyPI. The installation is as simple as:</p> pipuv <pre><code>pip install archeo\n</code></pre> <pre><code>uv add archeo\n</code></pre> <p>Most of archeo's functionality relies on:</p> <ul> <li><code>pandas</code>: Core data manipulation library.</li> <li><code>surfinbh</code>: Surrogate final Black Hole properties for mergers of binary black holes.</li> <li><code>corner</code>: Corner plot visualization library.</li> </ul> <p>If you've got Python 3.11+ and <code>pip</code> installed, you're good to go.</p>"},{"location":"installation/#optional-dependencies","title":"Optional dependencies","text":"<p>Archeo has the following optional dependency group:</p> <ul> <li><code>archeo[ui]</code>: Web UI features powered by Streamlit</li> </ul> <p>To install optional dependencies along with archeo, use one of the following commands:</p> pipuv <pre><code># with the `ui` extra:\npip install 'archeo[ui]'\n</code></pre> <pre><code># with the `ui` extra:\nuv add 'archeo[ui]'\n</code></pre>"},{"location":"installation/#install-from-repository","title":"Install from repository","text":"<p>And if you prefer to install archeo directly from the repository:</p> pipuv <pre><code>pip install 'git+https://github.com/wyhwong/archeo@main'\n# or with UI features:\npip install 'git+https://github.com/wyhwong/archeo@main#egg=archeo[ui]'\n</code></pre> <pre><code>uv add 'git+https://github.com/wyhwong/archeo@main'\n# or with UI features:\nuv add 'git+https://github.com/wyhwong/archeo@main#egg=archeo[ui]'\n</code></pre>"},{"location":"methodology/","title":"Methodology","text":"<p>We study the ancestral binaries of sources of gravitational-wave observations under the hypothesis that these events contain second-generation black holes born from a previous binary black hole merger. We could approach this study by two main methods:</p> <ul> <li>Forward modeling: adopt a hierarchical Bayesian formalism, placing priors on the hypothesized ancestral binaries and marginalizing over the source properties of black holes to directly obtain posteriors on ancestral properties. In this approach, the analysis is conditioned on the observed data. See Mahapatra et al., 2024.</li> <li>Backward modeling: adopt the same priors on the source properties of gravitational-wave events. Instead of conditioning on the observed data, in backward approach, we condition on the existing parameter estimation samples of the observed events to infer the properties of ancestral binaries. See Ara\u00fajo \u00c1lvarez et al., 2024.</li> </ul> <p>For a more detailed comparison of these two approaches, you may refer to the Appendix E of The LIGO Scientific Collaboration, the Virgo Collaboration, and the KAGRA Collaboration et al., 2025.</p> <p>In archeo, we implement the backward modeling approach to study the ancestral binaries of observed gravitational-wave events. This methodology allows us to efficiently explore the parameter space of potential ancestral binaries without the computational overhead of forward modeling. By leveraging existing parameter estimation samples, we can infer the distributions of ancestral properties and gain insights into the formation channels of second-generation black holes.</p> <p>Currently, we also support forward modeling approach through importance sampling, which allows us to re-weight existing samples based on new priors placed on ancestral binaries. This hybrid approach provides flexibility in analyzing gravitational-wave events and to some extent avoids the need to re-run full hierarchical Bayesian analyses from scratch.</p>"},{"location":"posterior-backward/","title":"Posterior","text":"<p>Posteriors refer to the posterior probability distributions for each ancestral model parameter.</p>"},{"location":"posterior-backward/#infer-posterior-by-backward-approach","title":"Infer Posterior by Backward approach","text":"<p>After generating a prior, you may want to use it in a backward model to infer ancestral posterior distributions. As mentioned in the methodology, the backward approach conditions on the existing parameter estimation samples. We therefore will need to first prepare the mass and spin posterior samples from a parameter estimation run.</p> <p>For example, if you have a JSON file containing the posterior samples, you can load it using pandas as follows:</p> <pre><code>samples = pd.read_json(\"path/to/pe_samples.json\")\n\nmass_posterior = samples[\"mass_1_source\"]\nspin_posterior = samples[\"a_1\"]\n</code></pre> <p>Then the next step to obtain the posteriors from the backward model could be simply done as follows:</p> <pre><code>posterior = prior.to_posterior(\n    mass_posterior=mass_posterior,\n    spin_posterior=spin_posterior,\n)\n</code></pre>"},{"location":"posterior-backward/#tolerance-in-matching-prior-and-posterior-samples","title":"Tolerance in Matching Prior and Posterior Samples","text":"<p>Due to the discrete nature of the prior samples, we will need a non-zero tolerance value to match the posterior samples with the prior samples. For details, please see the section of Practical Implementation in Ara\u00fajo \u00c1lvarez et al., 2024. By default, the tolerance is set to 0.05 for spin and 1.0 for mass (in unit of solar mass).</p> <p>To customize the tolerance values, you may specify them as follows:</p> <pre><code># NOTE: do this before calling to_posterior()\nprior.update_tolerances(\n    spin_tolerance=&lt;float&gt;, # dimensionless\n    mass_tolerance=&lt;float&gt;, # in unit of solar mass\n)\n</code></pre>"},{"location":"posterior-forward/","title":"Posterior","text":"<p>To be ready!</p>"},{"location":"prior-backward/","title":"Prior","text":"<p>Priors refer to the prior probability distributions for each ancestral model parameter.</p>"},{"location":"prior-backward/#initializing-preset-priors","title":"Initializing Preset Priors","text":"<p>Initializing a preset prior in archeo is straightforward. For example, to initialize a tiny aligned spin prior (for testing), you can use the following code:</p> <pre><code>import archeo\n\nprior = archeo.Prior.from_config(\"default\")\n</code></pre> <p>Note that the prior initialization will take some time for:</p> <ol> <li>Downloading the fits model if not already cached.</li> <li>Generating samples from the fits model.</li> </ol> <p>The wait time mainly depends on the number of samples specified in the prior configuration. During the sample generation process, you will see progress bars indicating the status of sample generation.</p> <p>If you have generated the prior samples once, they could be cached locally for future use, and subsequent initializations will be much faster.</p> <pre><code>prior.to_parquet(\"path/to/save/prior.parquet\")\n\n# NOTE: this function also works for json/csv/feather format\nprior = archeo.Prior.from_filepath(\"path/to/save/prior.parquet\")\n</code></pre> <p>You may replace the string <code>\"tiny_aligned_spin\"</code> with any other supported preset prior name, here we list all available preset priors and corresponding configurations:</p> Name Samples Fits Model Spin Aligned Only Up-Aligned Spin $\\chi_1$ $\\chi_2$ $\\phi_1$ [rad] $\\phi_2$ [rad] $\\theta_1$ [rad] $\\theta_2$ [rad] $m_1 [M_\\odot]$ $m_2 [M_\\odot]$ $q$ Uniform in $q$ default (tiny_aligned_spin) 5,000 NRSur3dq8Remnant \u2705 \u274c 0 - 1 0 - 1 0 - $2\\pi$ 0 - $2\\pi$ 0 - $\\pi$ 0 - $\\pi$ 5 - 200 5 - 200 1 - 6 \u274c agnostic_precessing_spin 2,000,000 NRSur7dq4Remnant \u274c \u274c 0 - 1 0 - 1 0 - $2\\pi$ 0 - $2\\pi$ 0 - $\\pi$ 0 - $\\pi$ 5 - 200 5 - 200 1 - 6 \u274c agnostic_aligned_spin 2,000,000 NRSur3dq8Remnant \u2705 \u274c 0 - 1 0 - 1 0 - $2\\pi$ 0 - $2\\pi$ 0 - $\\pi$ 0 - $\\pi$ 5 - 200 5 - 200 1 - 6 \u274c precessing_spin 2,000,000 NRSur7dq4Remnant \u274c \u274c 0 - 1 0 - 1 0 - $2\\pi$ 0 - $2\\pi$ 0 - $\\pi$ 0 - $\\pi$ 5 - 65 5 - 65 1 - 6 \u274c aligned_spin 2,000,000 NRSur3dq8Remnant \u2705 \u274c 0 - 1 0 - 1 0 - $2\\pi$ 0 - $2\\pi$ 0 - $\\pi$ 0 - $\\pi$ 5 - 65 5 - 65 1 - 6 \u274c positively_aligned_spin 2,000,000 NRSur3dq8Remnant \u2705 \u2705 0 - 1 0 - 1 0 - $2\\pi$ 0 - $2\\pi$ 0 - $\\pi$ 0 - $\\pi$ 5 - 65 5 - 65 1 - 6 \u274c"},{"location":"prior-backward/#customizing-prior-configurations","title":"Customizing Prior Configurations","text":"<p>You can also create a customized prior configuration using the data structure in archeo:</p> <pre><code>from archeo.schema import Domain, PriorConfig\n\nprior_config = PriorConfig(\n    n_samples=&lt;int&gt;,\n    is_spin_aligned=&lt;True/False&gt;,\n    m_1=Domain(low=&lt;float&gt;, high=&lt;float&gt;),  # unit: solar mass\n    m_2=Domain(low=&lt;float&gt;, high=&lt;float&gt;),  # unit: solar mass\n    a_1=Domain(low=&lt;float&gt;, high=&lt;float&gt;),  # unit: dimensionless\n    a_2=Domain(low=&lt;float&gt;, high=&lt;float&gt;),  # unit: dimensionless\n)\n\nprior = archeo.Prior.from_config(prior_config)\n</code></pre> <p>To have more specific control over the prior configuration, you may want to look into archeo.schema. We provide some extra configuration options such as <code>is_only_up_aligned_spin</code> and <code>is_uniform_in_mass_ratio</code> to help you set up your desired prior easily.</p> <p>We also implemented an astrophysical motivated mass distribution prior based on Mahapatra et al., 2022. You can enable this mass function by setting the flag <code>is_mahapatra_mass_func=True</code> in the <code>PriorConfig</code>.</p>"},{"location":"prior-forward/","title":"Prior","text":"<p>To be ready!</p>"},{"location":"notebooks/gw190521_2g1g/","title":"Advanced - GW190521 BH1 as 3rd gen BH","text":"<p>In this notebook, we perform a quick demonstration of using archeo to analyze the GW190521 event, assuming the primary black hole is a third generation black hole (yield from a previous merge of one second generation black hole and one first generation black hole). Again, similar to <code>gw190521_quick.ipynb</code>, we will use a subsampled version of the LVK posterior samples for GW190521 as our input data. The full dataset can be found dcc.ligo.</p> <p>The notebook run should take less than 5 minute to complete.</p> In\u00a0[1]: Copied! <pre>import pandas as pd\nimport archeo\nfrom archeo.schema import Domain, PriorConfig\nfrom archeo.core.simulator import Simulator\n</pre> import pandas as pd import archeo from archeo.schema import Domain, PriorConfig from archeo.core.simulator import Simulator In\u00a0[2]: Copied! <pre>import warnings\n\nwarnings.filterwarnings(\"ignore\", category=UserWarning)\nwarnings.filterwarnings(\"ignore\", category=FutureWarning)\nwarnings.filterwarnings(\"ignore\", category=RuntimeWarning)\n</pre> import warnings  warnings.filterwarnings(\"ignore\", category=UserWarning) warnings.filterwarnings(\"ignore\", category=FutureWarning) warnings.filterwarnings(\"ignore\", category=RuntimeWarning) In\u00a0[3]: Copied! <pre>prior_config = PriorConfig(\n    n_samples=5000,\n    is_spin_aligned=False,\n    m_1=Domain(5, 65),\n    m_2=Domain(5, 65),\n    a_1=Domain(0, 1.0),\n    a_2=Domain(0, 1.0),\n)\nsimulator = Simulator(prior_config=prior_config)\n\n# Generate a 2g prior\nprior_2g = archeo.Prior.from_simulator(simulator)\n\n# Here we use sample from the 2g prior for the primary black hole\nsimulator.use_remnant_results(df_bh1=prior_2g)\nprior_2g1g = archeo.Prior.from_simulator(simulator)\n</pre> prior_config = PriorConfig(     n_samples=5000,     is_spin_aligned=False,     m_1=Domain(5, 65),     m_2=Domain(5, 65),     a_1=Domain(0, 1.0),     a_2=Domain(0, 1.0), ) simulator = Simulator(prior_config=prior_config)  # Generate a 2g prior prior_2g = archeo.Prior.from_simulator(simulator)  # Here we use sample from the 2g prior for the primary black hole simulator.use_remnant_results(df_bh1=prior_2g) prior_2g1g = archeo.Prior.from_simulator(simulator) <pre>Loaded NRSur7dq4Remnant fit.\n</pre> <pre>100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5000/5000 [00:30&lt;00:00, 166.48it/s]\nUsing remnant results for black hole 1. This will override the prior configuration for black hole 1.\n100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5000/5000 [00:30&lt;00:00, 165.08it/s]\n</pre> In\u00a0[4]: Copied! <pre>import matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom archeo.visualization.base import plot_pdf\n</pre> import matplotlib.pyplot as plt import seaborn as sns  from archeo.visualization.base import plot_pdf In\u00a0[5]: Copied! <pre># Verify Distribution in Priors\n\n# Here the distributions should be fairly close to each other\n#   since we are using the 2g prior samples\n#   for the primary black hole in the 2g1g prior.\n# However, the sample size is small so there will be some noise.\n\nfig, axes = plt.subplots(1, 2, figsize=(10, 5))\n\nplot_pdf(axes[0], prior_2g[\"m_f\"], \"blue\", name=\"2g Remnant Mass\", unit=\"M_\\odot\")\nplot_pdf(axes[0], prior_2g1g[\"m_1\"], \"lightblue\", name=\"2g1g BH1 Mass\", unit=\"M_\\odot\")\n\nplot_pdf(axes[1], prior_2g[\"a_f\"], \"blue\", name=\"2g Remnant Spin\")\nplot_pdf(axes[1], prior_2g1g[\"a_1\"], \"lightblue\", name=\"2g1g BH1 Spin\")\n\nfor i in range(2):\n    axes[i].set_title(\n        \"{param} Distribution Comparison\".format(param=\"Mass\" if i == 0 else \"Spin\")\n    )\n    axes[i].set_ylabel(\"Probability Density\")\n    axes[i].set_xlabel(\"Mass (M_\\odot)\" if i == 0 else \"Spin\")\n    axes[i].grid()\n    axes[i].legend()\n</pre> # Verify Distribution in Priors  # Here the distributions should be fairly close to each other #   since we are using the 2g prior samples #   for the primary black hole in the 2g1g prior. # However, the sample size is small so there will be some noise.  fig, axes = plt.subplots(1, 2, figsize=(10, 5))  plot_pdf(axes[0], prior_2g[\"m_f\"], \"blue\", name=\"2g Remnant Mass\", unit=\"M_\\odot\") plot_pdf(axes[0], prior_2g1g[\"m_1\"], \"lightblue\", name=\"2g1g BH1 Mass\", unit=\"M_\\odot\")  plot_pdf(axes[1], prior_2g[\"a_f\"], \"blue\", name=\"2g Remnant Spin\") plot_pdf(axes[1], prior_2g1g[\"a_1\"], \"lightblue\", name=\"2g1g BH1 Spin\")  for i in range(2):     axes[i].set_title(         \"{param} Distribution Comparison\".format(param=\"Mass\" if i == 0 else \"Spin\")     )     axes[i].set_ylabel(\"Probability Density\")     axes[i].set_xlabel(\"Mass (M_\\odot)\" if i == 0 else \"Spin\")     axes[i].grid()     axes[i].legend() In\u00a0[6]: Copied! <pre># Understand the remnant mass and spin distributions of the 2g1g prior\n# Here we should at least see the remnant mass distribution shifted to higher masses\n#   compared to the 2g prior since the primary black hole is more massive on average.\n\nfig, axes = plt.subplots(1, 2, figsize=(10, 5))\n\nplot_pdf(axes[0], prior_2g[\"m_f\"], \"blue\", name=\"2g Remnant Mass\", unit=\"M_\\odot\")\nplot_pdf(axes[0], prior_2g1g[\"m_f\"], \"lightblue\", name=\"2g1g Remnant Mass\", unit=\"M_\\odot\")\n\nplot_pdf(axes[1], prior_2g[\"a_f\"], \"blue\", name=\"2g Remnant Spin\")\nplot_pdf(axes[1], prior_2g1g[\"a_f\"], \"lightblue\", name=\"2g1g Remnant Spin\")\n\nfor i in range(2):\n    axes[i].set_title(\n        \"{param} Distribution Comparison\".format(param=\"Mass\" if i == 0 else \"Spin\")\n    )\n    axes[i].set_ylabel(\"Probability Density\")\n    axes[i].set_xlabel(\"Mass (M_\\odot)\" if i == 0 else \"Spin\")\n    axes[i].grid()\n    axes[i].legend()\n</pre> # Understand the remnant mass and spin distributions of the 2g1g prior # Here we should at least see the remnant mass distribution shifted to higher masses #   compared to the 2g prior since the primary black hole is more massive on average.  fig, axes = plt.subplots(1, 2, figsize=(10, 5))  plot_pdf(axes[0], prior_2g[\"m_f\"], \"blue\", name=\"2g Remnant Mass\", unit=\"M_\\odot\") plot_pdf(axes[0], prior_2g1g[\"m_f\"], \"lightblue\", name=\"2g1g Remnant Mass\", unit=\"M_\\odot\")  plot_pdf(axes[1], prior_2g[\"a_f\"], \"blue\", name=\"2g Remnant Spin\") plot_pdf(axes[1], prior_2g1g[\"a_f\"], \"lightblue\", name=\"2g1g Remnant Spin\")  for i in range(2):     axes[i].set_title(         \"{param} Distribution Comparison\".format(param=\"Mass\" if i == 0 else \"Spin\")     )     axes[i].set_ylabel(\"Probability Density\")     axes[i].set_xlabel(\"Mass (M_\\odot)\" if i == 0 else \"Spin\")     axes[i].grid()     axes[i].legend() In\u00a0[7]: Copied! <pre># This data file is a subset of the LVK posterior samples for GW190521\n# For the full dataset, please refer to: https://dcc.ligo.org/P2000158/public\n\ngw190521_pe_samples = pd.read_json(\"./gw190521_lvk_subsampled.json\")\ngw190521_pe_samples.head(10)\n</pre> # This data file is a subset of the LVK posterior samples for GW190521 # For the full dataset, please refer to: https://dcc.ligo.org/P2000158/public  gw190521_pe_samples = pd.read_json(\"./gw190521_lvk_subsampled.json\") gw190521_pe_samples.head(10) Out[7]: mass_1_source mass_2_source a_1 a_2 0 84.513663 76.297304 0.687007 0.899445 1 81.059729 69.663127 0.769092 0.878550 2 92.370429 86.105830 0.540142 0.949552 3 77.363091 67.721241 0.088123 0.973257 4 99.454443 41.802952 0.710768 0.976182 5 89.774109 72.749785 0.096520 0.859641 6 65.693613 63.273635 0.664623 0.867052 7 85.314123 58.547913 0.604760 0.867737 8 88.031480 85.329605 0.741590 0.659539 9 71.147886 65.844700 0.914395 0.073000 In\u00a0[8]: Copied! <pre>ancestors_bh1 = prior_2g1g.to_posterior(\n    mass_posterior=gw190521_pe_samples[\"mass_1_source\"],\n    spin_posterior=gw190521_pe_samples[\"a_1\"],\n)\nancestors_bh1.head(10)\n</pre> ancestors_bh1 = prior_2g1g.to_posterior(     mass_posterior=gw190521_pe_samples[\"mass_1_source\"],     spin_posterior=gw190521_pe_samples[\"a_1\"], ) ancestors_bh1.head(10) <pre>100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5000/5000 [00:12&lt;00:00, 415.80it/s]\n</pre> <pre>2025-11-09T18:59:07Z [archeo.core.prior | WARNING]: 1198 / 5000 samples could not be recovered from the prior.\n</pre> Out[8]: m_1 m_2 k_1 k_2 m_ret m_ret_err v_f v_f_err chi_1 chi_2 ... k_f a_f a_1 a_2 chi_eff chi_p min_v_esc l original_a_f original_m_f 0 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ... NaN NaN NaN NaN NaN NaN NaN 0.0000 0.109709 82.082266 1 71.204425 14.172562 511.298051 0.0 0.986825 0.000587 [7.5903675243773e-05, -0.0008879776145372901, ... [0.00014828238687034746, 0.0001497023364278512... (-0.22962292543145948, 0.18923465380194923, -0... (-0.692094664725603, -0.5685079031773203, 0.05... ... 291.832195 0.197302 0.749118 0.897049 -0.565064 0.297551 511.298051 0.0002 0.169938 83.604518 2 41.798804 38.104399 674.616908 0.0 0.939449 0.000183 [0.0006271178398085629, 0.00016146637348435014... [5.096434506665966e-05, 6.251237321650113e-05,... (0.4147125140140576, 0.021600654003196162, 0.4... (0.0727494346633167, 0.8337288563262304, 0.229... ... 321.134549 0.814320 0.616334 0.867669 0.347462 0.752915 674.616908 0.0038 0.807190 75.441391 3 50.507383 22.451255 362.878616 0.0 0.969660 0.000087 [0.0014499279819373398, -0.0009111670299297066... [2.0289826974228573e-05, 1.748300030207926e-05... (-0.5625824679056167, 0.06230631454234143, -0.... (-0.009343606533680288, 0.0034809432290475177,... ... 661.840744 0.492061 0.751053 0.013297 -0.344454 0.566022 661.840744 0.0016 0.494414 71.471027 4 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ... NaN NaN NaN NaN NaN NaN NaN 0.0000 0.974215 115.865872 5 84.277370 17.355203 208.053391 0.0 0.984789 0.000416 [0.0003105909843097801, -0.0008690588951589406... [0.00010534579423901051, 0.0001212424903728573... (0.3072498181343961, -0.32464529461055314, -0.... (-0.2777779160223119, 0.715878211226382, -0.33... ... 328.867471 0.345211 0.571569 0.836306 -0.351968 0.446987 328.867471 0.0012 0.376884 100.479834 6 57.089193 49.594165 164.258957 0.0 0.937479 0.000083 [0.0003466309483827004, 0.00040668094931714836... [1.4162724964236232e-05, 1.419280812576271e-05... (0.33714705764251524, 0.17799102072936085, 0.5... (-0.29616105325939884, 0.04230318195360705, 0.... ... 1568.153566 0.800019 0.634804 0.406838 0.399785 0.381247 1568.153566 0.0092 0.771864 100.390105 7 62.935393 15.198522 132.826262 0.0 0.974628 0.000191 [2.1873143343116184e-05, 0.0008407952109766869... [4.9607558302975683e-05, 7.098371598370049e-05... (-0.22549971550134082, 0.6496014246533328, 0.1... (0.2386396585161865, 0.5020823482039425, 0.004... ... 252.228712 0.681422 0.698088 0.555931 0.097930 0.687628 252.228712 0.0048 0.662558 75.773648 8 85.711153 34.348968 752.255824 0.0 0.974169 0.000097 [0.0005376753721846334, -0.0009272148112844177... [2.4228746611720418e-05, 2.211138176951283e-05... (0.29498115199019936, -0.24524201316364277, -0... (-0.3936951889300472, 0.21474684826698906, -0.... ... 358.815577 0.376573 0.675051 0.588485 -0.505563 0.383611 752.255824 0.0006 0.340826 116.854193 9 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ... NaN NaN NaN NaN NaN NaN NaN 0.0000 0.078704 82.195220 <p>10 rows \u00d7 31 columns</p> In\u00a0[9]: Copied! <pre>## Visualize Inferred Posteriors of BH1's Ancestor\n\nfrom archeo.visualization.estimation import table_estimates\n</pre> ## Visualize Inferred Posteriors of BH1's Ancestor  from archeo.visualization.estimation import table_estimates In\u00a0[10]: Copied! <pre>table_estimates(\n    dfs={\n        \"Prior (Aligned Spin)\": prior_2g1g,\n        \"GW190521 BH1 Ancestor\": ancestors_bh1,\n    }\n)\n</pre> table_estimates(     dfs={         \"Prior (Aligned Spin)\": prior_2g1g,         \"GW190521 BH1 Ancestor\": ancestors_bh1,     } ) Out[10]: Recovery Rate p2g_GC p2g_MW p2g_NSC p2g_EG $m_1$ $m_2$ $q$ $m_f$ $a_f$ $v_f$ $\\chi_{p}$ $\\chi_{eff}$ 0 Prior (Aligned Spin) NaN 0.08 21.54 40.34 43.58 $68.93_{-35.29}^{+37.52}$ $35.01_{-21.90}^{+26.09}$ $1.86_{-0.79}^{+3.07}$ $102.56_{-51.98}^{+44.88}$ $0.67_{-0.28}^{+0.15}$ $587.58_{-428.15}^{+1016.57}$ $0.55_{-0.32}^{+0.22}$ $-0.00_{-0.45}^{+0.45}$ 1 GW190521 BH1 Ancestor 0.7604 0.04 24.50 41.74 45.68 $62.12_{-17.30}^{+19.55}$ $26.38_{-13.56}^{+19.61}$ $2.40_{-1.31}^{+3.00}$ $84.61_{-13.49}^{+20.35}$ $0.68_{-0.48}^{+0.20}$ $485.01_{-329.28}^{+1148.33}$ $0.47_{-0.32}^{+0.28}$ $0.05_{-0.61}^{+0.63}$"},{"location":"notebooks/gw190521_2g1g/#prepare-prior","title":"Prepare Prior\u00b6","text":"<p>For the 2g1g analysis, we will assume all hierarchical mergers undergo a generice spin setting including precession, similar to PPq6 in Ara\u00fajo \u00c1lvarez et al., 2024. Note that we assume the first generation black hole mass range is in [5, 65] solar masses based on PISN gap in [65, 130] solar masses. You may feel free to modify the upper limit based on your own assumptions.</p>"},{"location":"notebooks/gw190521_2g1g/#verify-distribution-in-priors","title":"Verify Distribution in Priors\u00b6","text":"<p>Here we quickly visualize the remnant mass and spin distributions of the 2g prior and the primary black hole mass and spin distributions of the 1g prior to ensure they are as expected.</p> <p>We will also visualize the remnant mass and spin distributions of the 2g1g prior to make a sense of what is happening.</p>"},{"location":"notebooks/gw190521_2g1g/#load-parameter-estimation-samples","title":"Load Parameter Estimation Samples\u00b6","text":"<p>Here the steps are identical to those in <code>gw190521_quick.ipynb</code>.</p>"},{"location":"notebooks/gw190521_2g1g/#visualize-inferred-posteriors-of-bh1s-ancestor","title":"Visualize Inferred Posteriors of BH1's Ancestor\u00b6","text":"<p>Here we just visualize the summary for convenience.</p>"},{"location":"notebooks/gw190521_quick/","title":"Quickstart - GW190521 BH1","text":"<p>In this notebook, we perform a quick demonstration of using archeo to analyze the GW190521 event, using an agnostic prior similar to APq6 in Ara\u00fajo \u00c1lvarez et al., 2024. We will use a subsampled version of the LVK posterior samples for GW190521 as our input data. The full dataset can be found dcc.ligo.</p> <p>The notebook run should take less than 3 minutes to complete. However, the values are reasonably close to the reported values of circular APq6 setting in Ara\u00fajo \u00c1lvarez et al., 2024.</p> In\u00a0[1]: Copied! <pre>import pandas as pd\nimport archeo\n</pre> import pandas as pd import archeo In\u00a0[2]: Copied! <pre>import warnings\n\nwarnings.filterwarnings(\"ignore\", category=UserWarning)\nwarnings.filterwarnings(\"ignore\", category=FutureWarning)\nwarnings.filterwarnings(\"ignore\", category=RuntimeWarning)\n</pre> import warnings  warnings.filterwarnings(\"ignore\", category=UserWarning) warnings.filterwarnings(\"ignore\", category=FutureWarning) warnings.filterwarnings(\"ignore\", category=RuntimeWarning) In\u00a0[3]: Copied! <pre>prior = archeo.Prior.from_config(\"tiny_aligned_spin\")\n</pre> prior = archeo.Prior.from_config(\"tiny_aligned_spin\") <pre>Loaded NRSur3dq8Remnant fit.\n</pre> <pre>100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5000/5000 [00:08&lt;00:00, 561.61it/s]\n</pre> In\u00a0[4]: Copied! <pre># This data file is a subset of the LVK posterior samples for GW190521\n# For the full dataset, please refer to: https://dcc.ligo.org/P2000158/public\n\ngw190521_pe_samples = pd.read_json(\"./gw190521_lvk_subsampled.json\")\ngw190521_pe_samples.head(10)\n</pre> # This data file is a subset of the LVK posterior samples for GW190521 # For the full dataset, please refer to: https://dcc.ligo.org/P2000158/public  gw190521_pe_samples = pd.read_json(\"./gw190521_lvk_subsampled.json\") gw190521_pe_samples.head(10) Out[4]: mass_1_source mass_2_source a_1 a_2 0 84.513663 76.297304 0.687007 0.899445 1 81.059729 69.663127 0.769092 0.878550 2 92.370429 86.105830 0.540142 0.949552 3 77.363091 67.721241 0.088123 0.973257 4 99.454443 41.802952 0.710768 0.976182 5 89.774109 72.749785 0.096520 0.859641 6 65.693613 63.273635 0.664623 0.867052 7 85.314123 58.547913 0.604760 0.867737 8 88.031480 85.329605 0.741590 0.659539 9 71.147886 65.844700 0.914395 0.073000 In\u00a0[5]: Copied! <pre>ancestors_bh1 = prior.to_posterior(\n    mass_posterior=gw190521_pe_samples[\"mass_1_source\"],\n    spin_posterior=gw190521_pe_samples[\"a_1\"]\n)\nancestors_bh1.head(10)\n</pre> ancestors_bh1 = prior.to_posterior(     mass_posterior=gw190521_pe_samples[\"mass_1_source\"],     spin_posterior=gw190521_pe_samples[\"a_1\"] ) ancestors_bh1.head(10) <pre>100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 5000/5000 [00:12&lt;00:00, 390.49it/s]\n</pre> <pre>2025-11-08T02:19:14Z [archeo.core.prior | WARNING]: 903 / 5000 samples could not be recovered from the prior.\n</pre> Out[5]: m_1 m_2 k_1 k_2 m_ret m_ret_err v_f v_f_err chi_1 chi_2 ... k_f a_f a_1 a_2 chi_eff chi_p min_v_esc l original_a_f original_m_f 0 56.807284 10.045555 0 0 0.983024 0.000147 [0.00031796378658697155, 0.0002404215978572215... [1.5124690533317877e-05, 1.5707690726432974e-0... (0.0, 0.0, 0.07632719366342322) (0.0, 0.0, 0.9545757671639021) ... 119.505379 0.444176 0.076327 0.954576 0.208296 0.0 119.505379 0.0004 0.456149 65.776486 1 59.139902 15.911495 0 0 0.963412 0.000139 [-0.00023546780394241283, 1.7411760354947028e-... [8.288770264452005e-06, 1.3540731189701679e-05... (0.0, 0.0, 0.5236860398616391) (0.0, 0.0, 0.8835312294979694) ... 70.593402 0.764198 0.523686 0.883531 0.599976 0.0 70.593402 0.0004 0.784819 71.457324 2 71.531182 22.685788 0 0 0.973713 0.000135 [0.0007355004909358907, 0.0001484246086434209,... [1.5307296013430054e-05, 1.5213542068321367e-0... (0.0, 0.0, -0.20628945301448265) (0.0, 0.0, 0.7627228632586837) ... 224.942422 0.456813 0.206289 0.762723 0.027032 0.0 224.942422 0.0012 0.490862 92.314619 3 50.898592 34.623116 0 0 0.936706 0.000126 [7.999006103908443e-05, 0.00014760713823479585... [1.0991301453002006e-05, 1.402400349748932e-05... (0.0, 0.0, 0.6253915489310714) (0.0, 0.0, 0.23228237667484364) ... 50.331464 0.827838 0.625392 0.232282 0.466243 0.0 50.331464 0.0008 0.875057 79.696677 4 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ... NaN NaN NaN NaN NaN NaN NaN 0.0000 0.169938 83.604518 5 67.158265 17.207332 0 0 0.967557 0.000130 [1.6355384263690463e-05, 0.0002235221617455698... [1.419377703506219e-05, 1.5715579487711452e-05... (0.0, 0.0, 0.5692808401490708) (0.0, 0.0, -0.7026799447732435) ... 67.189406 0.753571 0.569281 0.702680 0.309850 0.0 67.189406 0.0014 0.769092 81.059729 6 52.879382 20.394810 0 0 0.970454 0.000144 [0.0006235397799084672, -9.024110870305888e-05... [4.2519531082058204e-05, 3.5624756524062426e-0... (0.0, 0.0, -0.19053147415881366) (0.0, 0.0, -0.013101795196032384) ... 188.880030 0.496416 0.190531 0.013102 -0.141146 0.0 188.880030 0.0006 0.494414 71.471027 7 55.557975 32.397743 0 0 0.944302 0.000125 [0.00036902844799429127, 8.887346954303728e-05... [1.5173553839617617e-05, 1.560345347075874e-05... (0.0, 0.0, 0.6731801569930314) (0.0, 0.0, -0.332098409472559) ... 113.795029 0.803444 0.673180 0.332098 0.302894 0.0 113.795029 0.0006 0.799370 83.112215 8 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN ... NaN NaN NaN NaN NaN NaN NaN 0.0000 0.155479 101.056365 9 52.272354 24.739181 0 0 0.974247 0.000148 [0.00022282164373879897, -0.001010748238382026... [1.9156383836055934e-05, 1.876102577531256e-05... (0.0, 0.0, -0.8774779596445711) (0.0, 0.0, -0.42634636431965334) ... 310.290478 0.282864 0.877478 0.426346 -0.732556 0.0 310.290478 0.0002 0.327673 75.703424 <p>10 rows \u00d7 31 columns</p> In\u00a0[6]: Copied! <pre>from archeo.visualization.distribution import (\n    distribution_summary,\n    kick_against_spin_cmap,\n    kick_distribution_on_spin,\n)\n</pre> from archeo.visualization.distribution import (     distribution_summary,     kick_against_spin_cmap,     kick_distribution_on_spin, ) In\u00a0[7]: Copied! <pre>distribution_summary(prior, close=False)\n</pre> distribution_summary(prior, close=False) Out[7]: <pre>(&lt;Figure size 600x800 with 4 Axes&gt;,\n array([&lt;Axes: xlabel='Parent Mass Ratio $q$', ylabel='PDF'&gt;,\n        &lt;Axes: xlabel='Remnant Mass $m_f$ [$M_{\\\\odot}$]', ylabel='PDF'&gt;,\n        &lt;Axes: xlabel='Recoil Kick $v_f$ [$kms^{-1}$]', ylabel='PDF'&gt;,\n        &lt;Axes: xlabel='Spin $\\\\chi_f$', ylabel='PDF'&gt;], dtype=object))</pre> In\u00a0[8]: Copied! <pre>kick_against_spin_cmap(prior, close=False)\n</pre> kick_against_spin_cmap(prior, close=False) Out[8]: <pre>(&lt;Figure size 800x600 with 1 Axes&gt;,\n &lt;ScatterDensityAxes: title={'center': 'Remnant Kick against Remnant Spin'}, xlabel='Remnant Spin $\\\\chi_f$', ylabel='Remnant Kick $v_f$ [$kms^{-1}$]'&gt;)</pre> In\u00a0[9]: Copied! <pre>kick_distribution_on_spin(prior, close=False)\n</pre> kick_distribution_on_spin(prior, close=False) Out[9]: <pre>(&lt;Figure size 900x400 with 1 Axes&gt;, &lt;Axes: &gt;)</pre> In\u00a0[10]: Copied! <pre>from archeo.visualization.estimation import (\n    mass_estimates,\n    corner_estimates,\n    second_generation_probability_curve,\n    effective_spin_estimates,\n    precession_spin_estimates,\n    table_estimates,\n)\n</pre> from archeo.visualization.estimation import (     mass_estimates,     corner_estimates,     second_generation_probability_curve,     effective_spin_estimates,     precession_spin_estimates,     table_estimates, ) In\u00a0[11]: Copied! <pre>mass_estimates(ancestors_bh1, label=\"GW190521 BH1\", close=False)\n</pre> mass_estimates(ancestors_bh1, label=\"GW190521 BH1\", close=False) Out[11]: <pre>(&lt;Figure size 900x400 with 1 Axes&gt;, &lt;Axes: &gt;)</pre> In\u00a0[12]: Copied! <pre>corner_estimates(\n    dfs={\n        \"Prior (Aligned Spin)\": prior,\n        \"GW190521 BH1 Ancestor\": ancestors_bh1,\n    },\n    close=False,\n)\n</pre> corner_estimates(     dfs={         \"Prior (Aligned Spin)\": prior,         \"GW190521 BH1 Ancestor\": ancestors_bh1,     },     close=False, ) <pre>WARNING:root:Please install arviz to use the advanced features of corner\nWARNING:root:Please install arviz to use the advanced features of corner\nWARNING:root:Please install arviz to use the advanced features of corner\nWARNING:root:Please install arviz to use the advanced features of corner\n</pre> Out[12]: <pre>(&lt;Figure size 900x900 with 36 Axes&gt;,\n array([[&lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],\n        [&lt;Axes: ylabel='$m_2$ [$M_{\\\\odot}$]'&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;,\n         &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],\n        [&lt;Axes: ylabel='$m_f$ [$M_{\\\\odot}$]'&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;,\n         &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],\n        [&lt;Axes: ylabel='$v_f$ [km s$^{-1}$]'&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;,\n         &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;],\n        [&lt;Axes: ylabel='$a_f$'&gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;, &lt;Axes: &gt;,\n         &lt;Axes: &gt;],\n        [&lt;Axes: xlabel='$m_1$ [$M_{\\\\odot}$]', ylabel='$\\\\chi_{eff}$'&gt;,\n         &lt;Axes: xlabel='$m_2$ [$M_{\\\\odot}$]'&gt;,\n         &lt;Axes: xlabel='$m_f$ [$M_{\\\\odot}$]'&gt;,\n         &lt;Axes: xlabel='$v_f$ [km s$^{-1}$]'&gt;, &lt;Axes: xlabel='$a_f$'&gt;,\n         &lt;Axes: xlabel='$\\\\chi_{eff}$'&gt;]], dtype=object))</pre> In\u00a0[13]: Copied! <pre>second_generation_probability_curve(\n    dfs={\n        \"Prior (Aligned Spin)\": prior,\n        \"GW190521 BH1 Ancestor\": ancestors_bh1,\n    },\n    close=False,\n)\n</pre> second_generation_probability_curve(     dfs={         \"Prior (Aligned Spin)\": prior,         \"GW190521 BH1 Ancestor\": ancestors_bh1,     },     close=False, ) Out[13]: <pre>(&lt;Figure size 1000x800 with 1 Axes&gt;, &lt;Axes: &gt;)</pre> In\u00a0[14]: Copied! <pre>effective_spin_estimates(\n    dfs={\n        \"Prior (Aligned Spin)\": prior,\n        \"GW190521 BH1 Ancestor\": ancestors_bh1,\n    },\n    close=False,\n)\n</pre> effective_spin_estimates(     dfs={         \"Prior (Aligned Spin)\": prior,         \"GW190521 BH1 Ancestor\": ancestors_bh1,     },     close=False, ) Out[14]: <pre>(&lt;Figure size 1000x800 with 1 Axes&gt;, &lt;Axes: &gt;)</pre> In\u00a0[15]: Copied! <pre>precession_spin_estimates(\n    dfs={\n        \"Prior (Aligned Spin)\": prior,\n        \"GW190521 BH1 Ancestor\": ancestors_bh1,\n    },\n    close=False,\n)\n</pre> precession_spin_estimates(     dfs={         \"Prior (Aligned Spin)\": prior,         \"GW190521 BH1 Ancestor\": ancestors_bh1,     },     close=False, ) Out[15]: <pre>(&lt;Figure size 1000x800 with 1 Axes&gt;, &lt;Axes: &gt;)</pre> In\u00a0[16]: Copied! <pre>table_estimates(\n    dfs={\n        \"Prior (Aligned Spin)\": prior,\n        \"GW190521 BH1 Ancestor\": ancestors_bh1,\n    }\n)\n</pre> table_estimates(     dfs={         \"Prior (Aligned Spin)\": prior,         \"GW190521 BH1 Ancestor\": ancestors_bh1,     } ) Out[16]: Recovery Rate p2g_GC p2g_MW p2g_NSC p2g_EG $m_1$ $m_2$ $q$ $m_f$ $a_f$ $v_f$ $\\chi_{p}$ $\\chi_{eff}$ 0 Prior (Aligned Spin) NaN 1.20 10.38 10.38 10.38 $142.09_{-95.62}^{+52.46}$ $71.69_{-53.04}^{+85.34}$ $1.71_{-0.66}^{+3.04}$ $207.58_{-139.53}^{+115.43}$ $0.64_{-0.46}^{+0.26}$ $142.12_{-116.79}^{+209.47}$ $0.00_{-0.00}^{+0.00}$ $-0.00_{-0.71}^{+0.70}$ 1 GW190521 BH1 Ancestor 0.8194 8.12 49.94 49.94 49.94 $60.67_{-15.07}^{+19.90}$ $27.97_{-14.36}^{+18.90}$ $2.24_{-1.17}^{+3.00}$ $85.28_{-14.06}^{+20.77}$ $0.71_{-0.59}^{+0.23}$ $113.80_{-93.66}^{+225.41}$ $0.00_{-0.00}^{+0.00}$ $0.17_{-0.89}^{+0.60}$"},{"location":"notebooks/gw190521_quick/#prepare-prior","title":"Prepare Prior\u00b6","text":""},{"location":"notebooks/gw190521_quick/#load-parameter-estimation-samples","title":"Load Parameter Estimation Samples\u00b6","text":""},{"location":"notebooks/gw190521_quick/#infer-ancestor-samples","title":"Infer ancestor samples\u00b6","text":""},{"location":"notebooks/gw190521_quick/#visualize-prior","title":"Visualize Prior\u00b6","text":""},{"location":"notebooks/gw190521_quick/#visualize-inferred-posteriors-of-bh1s-ancestor","title":"Visualize Inferred Posteriors of BH1's Ancestor\u00b6","text":""}]}